<!DOCTYPE html>
<html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Security Researcher in Reversing/Malware/Low Level fields">
    <meta name="Author" content="Midnight Reverser">
    <meta name="keywords" content="midnighthackings midnight-rev midnight">
    <link rel="stylesheet" href=https://blog.midnighthackings.com/css/syntax.css>
    <link rel="stylesheet" href=https://blog.midnighthackings.com/css/style.css>
    <script src="https://kit.fontawesome.com/1b7478c139.js" crossorigin="anonymous"></script>
    <title>Midnight Hackings - #FimDaEscala6x1</title>
  </head><body><aside id="sidenav">
    <header>
    
        <a href=https://blog.midnighthackings.com/><img src="https://blog.midnighthackings.com/avatar.png" alt="avatar"></a>
        
    

    <a id="branding" href=https://blog.midnighthackings.com/>
        
            Midnight's Home
        
    </a>
    </header>

    <nav>
        
            		
            <a href="/posts"
                
            >
                <i class="fas fa-keyboard fa-ms"></i>
                <span>posts</span>
            </a>
        
            		
            <a href="/tags"
                
            >
                <i class="fas fa-tags fa-ms"></i>
                <span>tags</span>
            </a>
        
            		
            <a href="https://github.com/midnight-rev"
                
                    target="_blank"
                
            >
                <i class="fab fa-github fa-ms"></i>
                <span>github</span>
            </a>
        
            		
            <a href="/index.xml"
                
            >
                <i class="fas fa-rss fa-ms"></i>
                <span>RSS</span>
            </a>
        
            		
            <a href="/contact"
                
            >
                <i class="far fa-envelope"></i>
                <span>contact</span>
            </a>
        
    </nav>
</aside>
<main id="main">
            <a href="javascript:void(0)" id="closebtn" onclick="navToggle()"><i class="fas fa-bars fa-lg"></i></a>
            <div class="content">
<code>
    <center>
    <p style="font-weight: bolder;color: red;"> Midnight Hackings apoia o fim da escala 6x1. </p>
    <p style="font-weight: bolder;color: red;">Todos nós trabalhadores devemos ter direito à vida além do trabalho! Trabalhadores unidos mudam o mundo.</p>
    </center>
</code>
    
    <h1 id="title">Pentest 0x01 - Information Gathering Pt 1</h1>
    
    
      
    <nav id="TableOfContents">
  <ul>
    <li><a href="#passive-information-gathering">Passive Information Gathering</a></li>
  </ul>

  <ul>
    <li><a href="#informações-de-ips-e-domínios">Informações de IPs e domínios</a>
      <ul>
        <li><a href="#whois">whois</a></li>
      </ul>
    </li>
    <li><a href="#passive-dns">Passive DNS</a>
      <ul>
        <li><a href="#dnsdumpster">DNSDumpster</a></li>
        <li><a href="#sublist3r">sublist3r</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#netcraft">Netcraft</a></li>
        <li><a href="#tecnologias">Tecnologias</a></li>
        <li><a href="#wayback-machine">WayBack Machine</a></li>
        <li><a href="#waf">WAF</a></li>
      </ul>
    </li>
    <li><a href="#google-hacking--ghdb">Google Hacking &amp; GHDB</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#shodan">Shodan</a></li>
    <li><a href="#emails">Emails</a>
      <ul>
        <li><a href="#theharverster">theHarverster</a></li>
      </ul>
    </li>
    <li><a href="#credenciais-vazadas">Credenciais Vazadas</a></li>
    <li><a href="#outros">Outros</a></li>
  </ul>
</nav>
    <h1 id="introdução">Introdução</h1>
<p>E prosseguimos na jornada rumo à eJPT! Agora, vamos ver como prosseguir nas atividades após o firmamento de um contrato de pentest.</p>
<h1 id="information-gathering">Information Gathering</h1>
<p>A primeira etapa técnica de um Pentest é a busca de mais informações sobre o alvo, também chamada de Information Gathering (que também é chamada/engloba a fase de Enumeração, em algumas literaturas). Um pentest de sucesso tem sua base em uma boa coleta de informações do alvo, sendo esses tipos de informação os mais diversos possíveis: IPs, domínios, softwares, e-mails, senhas, trabalhos, pesquisas, pessoas, organização da empresa etc.</p>
<p>É essa a fase que mais se gasta tempo, e também é a que constrói a base para as fases posteriores, portanto, invista um tempo considerável apenas pesquisando pelo seu alvo. Sabemos que um aprendiz sempre irá buscar por mais &ldquo;ação&rdquo; e querer logo infectar o sistema, pegar uma reverse shell e ownar o AD, mas tentar realizar essas ações sem planejamento, busca e mapeamento de informações e ativos da rede pode trazer problemas nas próximas fases.</p>
<p>Ao finalizar essa fase, o pentester terá mapeado a superfície de ataque da companhia contratante, ou seja, terá a visão de um atacante externo com relação às informações disponíveis.</p>
<p>Como saber o que é importante a pesquisar? Só é possível saber se algo será utilizado ou não no Pentest quando realmente for, logo, anote e armazene o máximo de informações encontradas, mesmo que elas possam não fazer sentido nessa fase. É melhor sobrar do que faltar :)</p>
<p>E por onde começamos a pesquisar? Bem, antes de sabermos como, o quê, e onde pesquisarmos, é importante separarmos a busca de informações em dois tipos: passiva e ativa. Saber diferenciá-las é vital para certos tipos de atividades e contratos que requerem uma ação mais furtiva ou agressiva, entretanto, note que muitas vezes uma determinada ação pode ser considerada um misto de <em>passive</em> com <em>active</em>.</p>
<h2 id="passive-information-gathering">Passive Information Gathering</h2>
<p>A busca de informações de forma passiva é aquela realizada sem interação direta com o alvo. Pensando de forma mais estrita, isso não permitiria nem acessar o website institucional do alvo, apenas utilizar ferramentas de terceiros para acessá-lo. Entretanto, há literaturas que definem Passive Information Gathering de forma menos restritiva, permitindo ao profissional que realize ações de um usuário comum. Por exemplo, se o alvo é um e-commerce, realizar um cadastro, login e pesquisar por produtos são ações de clientes, que não devem levantar suspeitas por partes de tecnologias ou times de segurança.</p>
<p><em>Open Source Intelligence</em> (OSINT) é um outro nome dado a essa procura passiva, baseada em fontes abertas, como sites de emprego, pesquisas publicadas sobre tecnologias, linkedin, histórico de DNS, tecnologias utilizadas na construção do site e servidores, entre outras fontes na vastidão da Internet. Devido à globalização, até mesmo pequenas empresas marcam presença na Internet, permitindo que existam rastros, ou &ldquo;pegadas&rdquo; que podem ser utilizadas para nosso engajamento ofensivo.</p>
<p>É importante notar que, devido à sua natureza passiva, essa etapa não gera alertas ou investigações de times de segurança, pois não há interação direta com o alvo. Logo, é a forma mais furtiva de obter informações e que pode ser utilizada sem problemas quanto a essas questões.</p>
<p>Dito isso, abaixo estão descritas algumas ferramentas que podem ser utilizadas para a realização de Passive Information Gathering.</p>
<h1 id="ferramentas-e-plataformas-para-passive-information-gathering">Ferramentas e plataformas para Passive Information Gathering</h1>
<h2 id="informações-de-ips-e-domínios">Informações de IPs e domínios</h2>
<p>Mapear o máximo possível de hosts, intervalos de endereços, subdomínios com IPs existentes (ou não mais gerenciados, suscetíveis a <a href="https://book.hacktricks.xyz/v/portugues-ht/pentesting-web/domain-subdomain-takeover"><em>Subdomain Takeover</em></a>) irá fornecer a superfície de ataque para descoberta de vulnerabilidades e configurações erradas em serviços, que serão fundamentais nas próximas fases do pentest.</p>
<h3 id="whois">whois</h3>
<p><em>whois</em> é um protocolo e também uma ferramenta que permite requisitar por informações do registrante do domínio, nameservers, e-mails do responsável pelo domínio e da empresa que disponibilizou para registro etc. A ferramenta já vem instalada por padrão no Kali Linux.</p>
<p>Abaixo estão algumas imagens contendo os resultados do <em>whois</em> para o domínio <strong>midnighthackings.com</strong>:</p>
<p><img src="img/ca62110c054f2e350de213ae5fc2d6df.png" alt="ca62110c054f2e350de213ae5fc2d6df.png"></p>
<p><img src="img/dae1a9eede7815c1132cc0f69100775a.png" alt="dae1a9eede7815c1132cc0f69100775a.png"></p>
<p>Note que já podemos inferir algumas coisas sobre o domínio <strong>midnighthackings.com</strong>:</p>
<ul>
<li>O registro foi feito pelo provedor de domínios Squarespace (linha do <em>Registrar URL</em>);</li>
<li>Os nameservers são do google. Nameservers são servidores DNS que irão armazenar os registros do domínio, bem como traduzir os nomes dos subdomínios requisitados para os IPs respectivos;</li>
<li>Não é possível saber a maior parte das informações de quem registrou o domínio devido ao uso do serviço <em>whois privacy/domain privacy</em>. Entretanto, o país/estado estão públicos.</li>
</ul>
<p>Também é possível realizar o whois por plataformas webs que fornecem um cliente para o serviço. Abaixo estão alguns deles:</p>
<ul>
<li><a href="https://who.is/">https://who.is/</a></li>
<li><a href="https://viewdns.info/whois/">https://viewdns.info/whois/</a></li>
<li><a href="https://www.iana.org/whois">https://www.iana.org/whois</a></li>
<li><a href="https://registro.br/tecnologia/ferramentas/whois/">https://registro.br/tecnologia/ferramentas/whois/</a></li>
</ul>
<blockquote>
<p>A evolução do whois é o protocolo RDAP, que permite, entre outros recursos, domínios internacionalizados e uma padronização nos campos retornados. Pesquise via RDAP por <a href="https://client.rdap.org/">esse link.</a></p></blockquote>
<h4 id="intervalo-de-endereços">Intervalo de endereços</h4>
<p>Também é possível encontrar alguns IPs quando se pesquisa por um domínio - por exemplo, o IP dos nameservers. Realizar um whois para qualquer um desses IPs deve resultar nas informações da empresa que distribuiu esses IPs, bem como os intervalos de blocos que foram alocados para a empresa contratante. Dessa forma, é possível reunir possíveis hosts para uso futuro.</p>
<blockquote>
<p>Curiosidade: os blocos de IPv4 e as <em>Autonomous System Numbers</em> (ASNs) do mundo são distribuídos pela organização <em>Internet Assigned Numbers Authority</em> (IANA) para as diversas regiões do mundo pelas <em>Regional Internet Registry</em> (RIR), que as distribuem para os países e outras subdivisões. Abaixo está uma lista das RIRs e suas respectivas regiões.</p>
<p><img src="img/5b369a71356187aac8b838ef7fe474d5.png" alt="5b369a71356187aac8b838ef7fe474d5.png"></p></blockquote>
<h2 id="passive-dns">Passive DNS</h2>
<p>O DNS é um dos protocolos mais importantes da Internet, e é o responsável (principalmente) por responder requisições de resolução de nomes para IPs. Quando se aluga um domínio, é possível alterar as informações DNS a partir da plataforma contratada, que geralmente contém um nameserver próprio para uso dos clientes.</p>
<p>Vejamos alguns tipos de informação DNS:</p>
<ol>
<li><strong>A</strong> - registro IPv4; mapeia um nome para um endereço;</li>
<li><strong>AAAA</strong> - registro IPv6; mapeia um nome para um endereço;</li>
<li><strong>MX</strong> - armazena a informação sobre o servidor de e-mail do domínio;</li>
<li><strong>CNAME</strong> - permite realizar um <em>alias</em> (apelido) para um nome, permitindo acessar um host qualquer - inclusive de um domínio diferente - através de um alias do domínio que possui. Exemplo de uso: CNAME blog.midnighthackings.com é um alias para midnight-rev.github.io;</li>
<li><strong>PTR</strong> - permite realizar <em>reverse lookups</em> - o processo de buscar os nomes atribuídos a um IP;</li>
<li><strong>SOA</strong> - contém informações administrativas e úteis para realizar transferências de zona;</li>
<li><strong>TXT</strong> - pode ser utilizado para diversos fins; o mais comum é para realizar verificação do domínio - &ldquo;se você possui tal domínio, crie um registro TXT com esse nome e valor&rdquo;.</li>
</ol>
<p>O banco de dados de um servidor DNS é chamado de <em>zone file</em> e contém todos os registros (públicos e não públicos), sendo uma excelente fonte para o mapeamento da rede interna - caso exista um servidor malconfigurado! No próximo artigo veremos como podemos obter esse arquivo com <em>zone transfer</em>. Por enquanto, vamos nos ater a ferramentas que irão verificar o DNS de forma passiva para nós:</p>
<h3 id="dnsdumpster">DNSDumpster</h3>
<p>O <a href="https://dnsdumpster.com/">DNSDumpster</a> é uma plataforma que armazena o histórico DNS e é gratuita para buscas. Dentre os principais recursos, há o mapeamento dos blocos de IP no mapa terrestre, busca de nameservers, os registros (MX, TXT etc), serviços e portas abertas em hosts, além de um mapeamento em grafo. Entretanto, há um problema particular: essa ferramenta traz o histórico, uma foto do passado, que pode não refletir o presente.</p>
<p>Vejamos o resultado do DNSDumpster para o domínio <strong>midnighthackings.com</strong>:</p>
<p><img src="img/951297762305be890b8cdb37eb4e0992.png" alt="951297762305be890b8cdb37eb4e0992.png"></p>
<p>Note, na imagem acima, que a plataforma identificou um host, <em>ctf.midnighthackings.com</em> que estava, na data do scan do DNSDumpster, com o serviço SSH exposto com versão 7.4.</p>
<p>Abaixo está um exemplo da visão de grafo do mapeamento do domínio.</p>
<p><img src="img/cdf12db470d5f2bf744a5375ce59d766.png" alt="cdf12db470d5f2bf744a5375ce59d766.png"></p>
<h3 id="sublist3r">sublist3r</h3>
<p><em>sublist3r</em> é uma ferramenta que realiza uma busca passiva DNS em um domínio, tentando encontrar subdomínios. Isso é feito a partir de requisições para plataformas de busca, como o google, virustotal e yahoo. Dessa forma, não há contato direto do pentester com o alvo, mas pode haver bloqueios de certos provedores devido à enorme quantidade de requisições realizadas - use com cautela!</p>
<p>No Kali Linux, utilize o comando abaixo para instalar o sublist3r.</p>
<p><code>sudo apt update -y; sudo apt install sublist3r -y</code></p>
<p>O uso mais simples do sublist3r está expresso na imagem abaixo, passando o domínio via opção <strong>-d</strong>:</p>
<p><img src="img/451cfd77cb8d56ccd0e307b2845ec869.png" alt="451cfd77cb8d56ccd0e307b2845ec869.png"></p>
<p>Nesse caso, foram realizadas requisições para diversas engines de busca e houve retorno de 3 subdomínios: <em>blog.midnighthackings.com</em>, <em>ctf.midnighthackings.com</em> e <em>linux4hackers.midnighthackings.com</em>. Não é possível saber quais serviços estão disponíveis nesses subdomínios - ou até mesmo se eles estão ativos ainda - mas já são potenciais alvos para um scan nas próximas fases.</p>
<blockquote>
<p>A ferramenta também possui o recurso de bruteforce DNS, porém isso se enquadraria em busca de informações de forma ativa.</p></blockquote>
<h2 id="web">Web</h2>
<p>A web é regida pelos protocolos HTTP/HTTPS e é um dos protocolos mais utilizados, juntamente com o DNS. A maior parte das empresas e organizações têm um site institucional ou de e-commerce. No sentido de busca de informações de forma passiva, admitiremos o contato direto do pentester com o site de forma &ldquo;natural&rdquo; - como um cliente. Por exemplo, se é um site de e-commerce, o pentester poderá se cadastrar, fazer login, pesquisar por produtos, entre outras ações comuns.</p>
<p>Algumas informações que sites podem conter: tecnologias utilizadas para construção do frontend/backend, páginas administrativas, arquivos de backup expostos, credenciais e comentários com dados sensíveis no código-fonte.</p>
<h3 id="netcraft">Netcraft</h3>
<p><a href="https://searchdns.netcraft.com">Netcraft</a> é uma plataforma que traz diversas informações sobre um site/subdomínio, como tecnologias utilizadas, vulnerabilidades, entre outras.</p>
<p>Vejamos os resultados para o <em>blog.midnighthackings.com</em>:</p>
<p><img src="img/c0cbe07b1245041ee95d4daed61702bd.png" alt="c0cbe07b1245041ee95d4daed61702bd.png"></p>
<p>Pode ser destacado, na imagem acima, que o site <em><a href="https://blog.midnighthackings.com">https://blog.midnighthackings.com</a></em> é hospedado pelo Github. Dado que o subdomínio tem a palavra <em>blog</em> escrita, é possível inferir que o serviço HTTP que roda nele é uma página de blog e hospedada gratuitamente via <a href="https://pages.github.com/">Github Pages</a>, sendo um site estático.</p>
<p>O Netcraft também traz algumas informações sobre vulnerabilidades no SSL já conhecidas, mas nenhuma delas retornou como vulnerável.</p>
<p><img src="img/a1437648b707fb41fe2e4728d849a96c.png" alt="a1437648b707fb41fe2e4728d849a96c.png"></p>
<p>Também é possível saber qual o software que compôs o site: Hugo CMS. Esse é um gerador de sites estáticos a partir de arquivos Markdown.</p>
<p><img src="img/1287d239123157c5e53b666843a506f3.png" alt="1287d239123157c5e53b666843a506f3.png"></p>
<blockquote>
<p>Para o leitor, recomendo que faça o mesmo para o ctf.midnighthackings.com e o linux4hackers.midnighthackings.com</p></blockquote>
<h3 id="tecnologias">Tecnologias</h3>
<p>As tecnologias podem demonstrar quais softwares são mais utilizados para a construção dos sites da empresa, e isso pode levar a dois pontos principais para o pentester:</p>
<ul>
<li>vulnerabilidades a serem exploradas;</li>
<li>uso das tecnologias como forma de phishing, como e-mails falsos de atualização dos pacotes.</li>
</ul>
<h4 id="wappalyzer">Wappalyzer</h4>
<p><a href="https://chromewebstore.google.com/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg?hl=pt-BR">Wappalyzer</a> é uma extensão para navegador que, ao acessar uma página, permite identificar as tecnologias que a construiram.</p>
<p>Abaixo estão os resultados para <em>blog.midnighthackings.com</em>. Alguns pontos interessantes:</p>
<ul>
<li>a <em>Content Delivery Network</em>, que se encarrega da disponibilidade do site ao redor do mundo, é a Fastly;</li>
<li>o gerador de sites é o hugo e a plataforma que hospeda é o Github Pages - corroborando para o resultado no Netcraft;</li>
</ul>
<p><img src="img/b46d78802566a4e62734a8dbfca6d289.png" alt="b46d78802566a4e62734a8dbfca6d289.png"></p>
<blockquote>
<p>Para o leitor, recomendo que faça o mesmo para o ctf.midnighthackings.com e o linux4hackers.midnighthackings.com</p></blockquote>
<h4 id="whatweb">whatweb</h4>
<p>whatweb é uma ferramenta disponível no Kali Linux que irá fazer um trabalho semelhante ao que o Wappalyzer realiza. É mais um aliado que trará alguns resultados extras mais específicos, como o que encontrar no conteúdo da página.</p>
<p>Vejamos o resultado para os três subdomínios que encontramos:</p>
<p><img src="img/dbba60d2dc4c546931c8e2d1c323f452.png" alt="dbba60d2dc4c546931c8e2d1c323f452.png"></p>
<p>Alguns pontos a serem destacados:</p>
<ol>
<li><em>blog.midnighthackings.com</em>
<ul>
<li>Foi encontrado o e-mail <em><a href="mailto:midnight.reverser@outlook.com">midnight.reverser@outlook.com</a></em> na página, o que já pode ser utilizado para ataques de brute-force, password-spray, email spoof ou phishing;</li>
<li>Foi possível verificar o nome do autor do blog (<em>Midnight Reverser</em>) e a versão exata do hugo (0.121.2);</li>
<li>Também há possivelmente um Proxy Reverso para aceleração de conteúdo, o Varnish na versão 1.1.</li>
</ul>
</li>
<li><em>ctf.midnighthackings.com</em>
<ul>
<li>O site está rodando no servidor nginx/1.24.0;</li>
<li>O site pode ter sido contruído utilizando o projeto opensource <a href="https://ctfd.io/">CTFd</a>, que permite criar sites para eventos de CTF - desafios em segurança da informação.</li>
</ul>
</li>
<li><em>linux4hackers.midnighthackings.com</em>
<ul>
<li>Há um novo e-mail encontrado: <em><a href="mailto:books@midnighthackings.com">books@midnighthackings.com</a></em>;</li>
<li>Ao que parece, o site está por detrás da <em>Cloudflare</em>, um provedor estadunidense que provê vários serviços, dentre eles: <em>Web Application Firewall</em> (WAF), que proteje sites, e anonimização do IP original do servidor a partir do uso do WAF;</li>
<li>O gerador de conteúdo é o Gitbook, logo podemos inferir que o propósito desse subdomínio é de apresentar um livro, um manual ou documentação de algo;</li>
<li>Por fim, temos o título <em>Introdução | Linux básico para hackers</em>, que podemos inferir que é um livro com base em tudo que encontramos sobre esse subdomínio.</li>
</ul>
</li>
</ol>
<h3 id="wayback-machine">WayBack Machine</h3>
<p>Sites são vivos e dessa forma quero me referir a mudanças. Elas ocorrem ao longo do tempo, por vários motivos: mudança de design, de ideias ou até completa repaginação. Dessa forma, informações que outrora estavam disponíveis e podem ser benéficas para o pentest, podem não estar mais no ar.</p>
<p>O <a href="https://web.archive.org/">Wayback Machine</a>, da instituição Internet Archive, tem por objetivo armazenar um histórico da web através do armazenamento de uma &ldquo;foto&rdquo; dos sites. Logo, é bem provável que exista versões anteriores de alguns dos sites da empresa contratante, em especial se ela já tem anos de mercado e é bem conhecida nacionalmente/internacionalmente.</p>
<p>Vejamos o resultado para <em><a href="http://blog.midnighthackings.com">http://blog.midnighthackings.com</a></em>:</p>
<p><img src="img/3a5440e1f8acfbdb3279437197c2daed.png" alt="3a5440e1f8acfbdb3279437197c2daed.png"></p>
<p>Há snapshots do site no intervalo de 2022 a 2024. Selecionando o snapshot de 07 de julho de 2022, podemos ver o início do blog, com apenas um post e com um estilo totalmente diferente do atual.</p>
<p><img src="img/ba8cd157d90e558687288bd552701ec2.png" alt="ba8cd157d90e558687288bd552701ec2.png"></p>
<p>Algumas vezes é possível encontrar informações importantes para o pentest, mas nesse site só podemos especular que ele deva ter sido criado por volta de 2022.</p>
<h3 id="waf">WAF</h3>
<p>Os WAFs são firewalls que protegem os sites contra requisições automáticas e maliciosas. Para isso, as requisições devem passar primeiro por ele, que irá redirecionar as requisições não maliciosas para o site verdadeiro.</p>
<p>Para um pentest, isso tem implicação em scanners específicos de HTTP, em que serão necessários configurações específicas para bypassar os WAFs. Muitos WAFs, como a Cloudflare, também escondem o IP real do cliente, mas caso seja possível descobri-lo de alguma forma, realizar scans pelo IP real pode realizar bypass do WAF.</p>
<p>Bem, e como identificar WAFs? As ferramentas já citadas podem dar uma noção, mas podemos interagir minimamente com o website para identificar assinaturas de WAFs. Para isso, utilizaremos a ferramenta <em>wafw00f</em>, disponível no kali.</p>
<p>O uso mais básico da ferramenta é passando o site diretamente via linha de comando. Veja os resultados para os sites que encontramos anteriormente:</p>
<ul>
<li>
<p>blog.midnighthackings.com - Fastly WAF
<img src="img/ae0de33404aa1bcd3502d2d1754ebede.png" alt="ae0de33404aa1bcd3502d2d1754ebede.png"></p>
</li>
<li>
<p>ctf.midnighthackings.com - Sem WAF
<img src="img/2e62e87c986b6f060d8ae1d94b50ff6f.png" alt="2e62e87c986b6f060d8ae1d94b50ff6f.png"></p>
</li>
<li>
<p>linux4hackers.midnighthackings.com - Cloudflare
<img src="img/850781f171824a57763dbdb9d1cb9807.png" alt="850781f171824a57763dbdb9d1cb9807.png"></p>
</li>
</ul>
<h2 id="google-hacking--ghdb">Google Hacking &amp; GHDB</h2>
<p>Uma das ferramentas de Threat Intelligence que também é amplamente utilizada em pentest é o Google Hacking. Em resumo, é utilizar o Google Search ao nosso favor, fazendo pesquisas avançadas, com o uso de Dorks - termos especiais que permitem instruir o google a retornar coisas específicas sobre o alvo.</p>
<p>Dessa forma, é possível encontrar páginas &ldquo;escondidas&rdquo;, como painéis administrativos, diretórios de backup, diretórios com listagem aberta, entre outras falhas de configuração. Nesse artigo abordaremos apenas alguns exemplos, visto que é um assunto extenso, que garantiria um artigo inteiro sobre.</p>
<p>Para pesquisar sobre sites com possível vulnerabilidade de <a href="https://portswigger.net/web-security/sql-injection">SQL Injection</a> (ou até <a href="https://portswigger.net/web-security/access-control/idor">IDOR</a>), podemos utilizar a dork <em>inurl:.php?id=</em>, que irá retornar sites que na URL (<em>inurl</em>) contenham uma página PHP (.php) e um parâmetro modificável via GET (?id=). Não se preocupe se não entender esse parágrafo, isso ficará mais claro nos artigos de vulnerabilidades web.</p>
<p><img src="img/682f90c235edb1d59e3e38e46008b8b1.png" alt="682f90c235edb1d59e3e38e46008b8b1.png"></p>
<p>Podemos pesquisar também por páginas de subdomínios via &ldquo;site:*.dominio.com&rdquo;:</p>
<p><img src="img/9991f5d702cc68b0be9e7b66c1230d32.png" alt="9991f5d702cc68b0be9e7b66c1230d32.png"></p>
<p>Buscando por páginas com Directory Listing ativado - ou seja, é possível listar todo o conteúdo do diretório - via <em>intitle:&ldquo;index of&rdquo;</em>:</p>
<p><img src="img/b25d921c31e1b185289eecc65580214d.png" alt="b25d921c31e1b185289eecc65580214d.png"></p>
<p>Alguns outros dorks importantes para um pentest:</p>
<ul>
<li>filetype:pdf - páginas contendo arquivos de tipos específicos;</li>
<li>cache:site.com - busca por versões em cache (mais antigas) do site no google. Nem sempre disponível.</li>
</ul>
<h4 id="ghdb--dorksearch">GHDB &amp; Dorksearch</h4>
<p>Foi criado, no <a href="https://www.exploit-db.com/google-hacking-database">Exploit DB</a>, uma série de dorks a serem utilizadas para diversos fins. Dessa forma, pode não ser necessário criar uma dork do zero, mas sim alterar uma já existente que traz bons resultados:</p>
<p><img src="img/100467bfdcf88c1b17ccdfe1ee6e5bf4.png" alt="100467bfdcf88c1b17ccdfe1ee6e5bf4.png"></p>
<p>Também há o site <a href="https://dorksearch.com/">DorkSearch</a>, que auxilia na montagem e pesquisa de dorks.</p>
<p><img src="img/97d8d82325b3c266f6507808e0255d21.png" alt="97d8d82325b3c266f6507808e0255d21.png"></p>
<h2 id="shodan">Shodan</h2>
<p><a href="https://www.shodan.io/">Shodan</a> é uma plataforma que realiza crawling em IPs públicos e descobre quais serviços estão rodando nesses IPs. É uma excelente fonte de informações passivas, trazendo até mesmo imagens dos serviços, acesso a câmeras via IP expostas sem autenticação e busca de vulnerabilidades nos serviços encontrados.</p>
<p>Entretanto, note que, como outras fontes de informações passivas, o resultado pode não refletir o estado atual do que está disponível.</p>
<p>No Shodan, a pesquisa é feita via filtros <a href="https://www.shodan.io/search/filters">disponíveis na documentação</a>. Assim como nas Dorks, é possível concatená-los para retornar resultados mais específicos. Alguns filtros importantes são:</p>
<ul>
<li><strong>hostname:*.domain.com</strong> - pesquisa por hosts ligados ao domínio;</li>
<li><strong>net:10.0.0.0/24 - pesquisa</strong> por hosts ligados ao bloco de endereçõs CIDR;</li>
<li><strong>vuln:CVE-2017-0144</strong> - pesquisa por hosts com determinada vulnerabilidade.</li>
</ul>
<p>Abaixo estão alguns resultados do Shodan para os hosts ligados ao domínio <em>midnighthackings.com</em>:</p>
<p><img src="img/96ac49106bd480a8383be3b5ef639831.png" alt="96ac49106bd480a8383be3b5ef639831.png"></p>
<p>É possível verificar que há 3 portas abertas, com os serviços de SSH, HTTP e HTTPS disponíveis. É feito um <em>Banner Grabbing</em>, técnica que veremos nos próximos artigos, para identificar o serviço rodando, retornando, inclusive sua versão.</p>
<p>Note que o serviço SSH está em uma versão mais atualizada que o que encontramos na etapa do DNSDumpster. Isso significa que o crawler do Shodan visitou o host mais recentemente que o DNSDumpster. Para termos mais certeza sobre a versão correta que está exposta, é importante seguir em um Banner Grabbing de forma ativa.</p>
<p><img src="img/d4fc19193001a20b262097d63f493bce.png" alt="d4fc19193001a20b262097d63f493bce.png"></p>
<p>No shodan, também é possível verificar os registros DNS e assim encontrar cada vez mais hosts e configurações atrelados ao domínio:</p>
<p><img src="img/3110236b68029765d2624d575cf4cfd0.png" alt="3110236b68029765d2624d575cf4cfd0.png"></p>
<h2 id="emails">Emails</h2>
<p>E-mails podem ser utilizados de mil maneiras diferentes em um pentest, logo, coletá-los é uma etapa <strong>essencial</strong> de todo pentest. Eles podem ser utilizados para phishing, busca de vazamentos de credenciais, brute-force, password-spray, entre outros tipos de ataque.</p>
<h3 id="theharverster">theHarverster</h3>
<p>theHarverster é uma ferramenta que utilizará o bing e outras search engines para buscar por e-mails de forma passiva, dado um domínio. Note que ele realizará múltiplas requisições e pode ser necessário limitar os resultados para que não haja um bloqueio por parte do provedor.</p>
<p>O uso mais comum é <em>theHarverster -d domain.com -b bing</em>, no qual a opção <strong>-d</strong> determinará o domínio a ser pesquisado e <strong>-b</strong> o provedor de busca.</p>
<p>No caso do <em>midnighthackings.com</em> via bing, o theHarverster não encontrou nenhuma e-mail associado. Porém, já temos e-mails obtidos das fases anteriores, e por isso é importante não confiar cegamente em apenas uma única ferramenta no pentest - busque por outras ferramentas, procure manualmente!</p>
<p><img src="img/53ce8d53bc219e4e7a4a14e62eabff56.png" alt="53ce8d53bc219e4e7a4a14e62eabff56.png"></p>
<h2 id="credenciais-vazadas">Credenciais Vazadas</h2>
<p>Uma das fontes que atacantes e pentesters utilizam para realizar o acesso inicial na rede da empresa é através de uma conta legítima, válida, como um outlook, que tem uma senha vazada, reutilizada, e que não é atualizada há tempos.</p>
<p>Há diversos fóruns, canais de telegram e outras fontes que permitem realizar o download dessas bases de gigabytes de credenciais. Nesse artigo, trataremos apenas da ferramenta <a href="https://haveibeenpwned.com/">Have I Been Pwned</a>, que realiza uma busca nas mais diversas bases de dados vazadas e indica se já houve algum vazamento de credenciais para aquele e-mail.</p>
<p>Para o e-mail que encontramos, <em><a href="mailto:midnight.reverser@outlook.com">midnight.reverser@outlook.com</a></em>, não há vazamentos conhecidos (até agora!). Esse processo deve ser feito com todos os e-mails que foram encontrados, além de buscar as credenciais nas bases de dados e testá-las para acesso - tudo isso agrega qualidade ao relatório.</p>
<p><img src="img/695aa2aac59a62f68aa5a84409b187b9.png" alt="695aa2aac59a62f68aa5a84409b187b9.png"></p>
<h2 id="outros">Outros</h2>
<p>O mundo de busca de informações é imenso e não cobrimos 10% do que pode ser realizado de forma passiva. Desse modo, é importante que o leitor procure por si próprio, invista um tempo praticando e busque mais plataformas/ferramentas. Damos o pontapé inicial, agora é com você :)</p>
<p>Seguem algumas outras fontes que podem ser importantes para essa etapa:</p>
<ul>
<li>Github, Github Gist, Gitlab, repositórios</li>
<li>Gitleaks, gitrob</li>
<li>Sites de emprego</li>
<li>Ferramenta Maltego</li>
<li><a href="https://osintframework.com/">OSINT Framework</a></li>
<li><a href="https://github.com/osintbrazuca/osint-brazuca">OSINT Brazuca</a></li>
</ul>

    
    <div class="nav-next-prev">
        <div class="nav-prev">
            
                <a href="https://blog.midnighthackings.com/posts/my-journey-into-pentest-0x00/"><i class="fas fa-chevron-left"></i></a>
            
        </div>
        <a class="nav-top" href="#">top</i></a>
        <div class="nav-next">
            
                <a href="https://blog.midnighthackings.com/posts/malware-analysis-0x00/"><i class="fas fa-chevron-right"></i></a>
            
        </div>
    </div>
    

            </div><footer>
<div class="footer-content">

  <div class="contact-info">
      
          <div class="footer-mail">
          <i class="far fa-envelope"></i> <a href="mailto:midnight.reverser@outlook.com">midnight.reverser@outlook.com</a> </div>
      
      
  </div>


<img src="https://www.gnu.org/graphics/gplv3-with-text-136x68.png"/>
&nbsp;&nbsp;
<p class="copyright meta"> Midnight Hackings apoia GPL e o fim da escala 6x1!</p>

</div>
</footer></main>
    </body>
    <script src=https://blog.midnighthackings.com/js/navbutton.js></script>
</html>
